var VA_WAP={};VA_WAP.wapver="";VA_WAP.shopid="";VA_WAP.pagetype="";VA_WAP.namespace=function(c){var a=c.split("."),b=VA_WAP;for(i=(a[0]=="VA_WAP")?1:0;i<a.length;i++){b[a[i]]=b[a[i]]||{};b=b[a[i]]}};VA_WAP.namespace("Lang");VA_WAP.Lang.trim=function(a){return a.replace(/^\s+|\s+$/g,"")};VA_WAP.Lang.isEmpty=function(a){return/^\s*$/.test(a)};VA_WAP.Lang.isNone=function(a){return((typeof a=="undefined")||a==null||((typeof a=="string")&&VA_WAP.Lang.trim(a)=="")||a=="undefined")};VA_WAP.Lang.isNumber=function(a){return!isNaN(a)};VA_WAP.Lang.random=function(a,c){var b=c-a+1;return Math.floor(Math.random()*b+a)};VA_WAP.Lang.dateTimeStrWms0=function(b){try{var h=b.getFullYear()}catch(f){b=new Date()}var c=b.getMonth()+1;c=c<10?"0"+c:""+c;var g=b.getDate();g=g<10?"0"+g:""+g;var d=b.getHours();d=d<10?"0"+d:""+d;var e=b.getMinutes();e=e<10?"0"+e:""+e;var j=b.getSeconds();j=j<10?"0"+j:""+j;var a=b.getMilliseconds();if(a<10){a="00"+a}else{if(a<100){a="0"+a}}return b.getFullYear()+c+g+d+e+j+a};VA_WAP.Lang.timeSeq32=function(){return VA_WAP.Lang.dateTimeStrWms0()+VA_WAP.Lang.random(100000000000000,999999999999999)};VA_WAP.namespace("Http");VA_WAP.Http={isIp:function(a){var b=/^(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])$/;return(b.test(a))},getQueryStringArgs:function(){var g=(location.search.length>0?location.search.substring(1):"");var e={};var f=g.split("&");var j=null,a=null,h=null;for(var c=0;c<f.length;c++){j=f[c].split("=");if(j.length>1){try{a=decodeURIComponent(j[0]);h=decodeURIComponent(j[1]);e[a]=h}catch(d){}}}var b=(window.location.hash.length>0?window.location.hash.substring(1):"");f=b.split("&");for(var c=0;c<f.length;c++){j=f[c].split("=");if(j.length>1){try{a=decodeURIComponent(j[0]);h=decodeURIComponent(j[1]);e[a]=h}catch(d){}}}return e}};VA_WAP.namespace("Dom");VA_WAP.Dom.loadScriptURL=function(b){var a=document.createElement("script");a.type="text/javascript";a.src=b;document.body.appendChild(a)};VA_WAP.Dom.loadImageBeacon=function(b){var a=document.createElement("img");a.type="image/png";a.src=b;a.border=0;a.height=1;a.width=1;document.body.appendChild(a)};VA_WAP.namespace("Event");VA_WAP.Event={getEvent:function(a){return a?a:window.event},getTarget:function(a){a=a?a:window.event;return a.target||a.srcElement},stopPropagation:function(a){a=a?a:window.event;if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}},preventDefault:function(a){a=a?a:window.event;if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}},addHandler:function(a,c,b){a=typeof a=="string"?document.getElementById(a):a;if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}else{a["on"+c]=b}}}};VA_WAP.namespace("Cookie");VA_WAP.Cookie={get:function(b){var f=null;var d=document.cookie.split("; ");for(var c=0,a=d.length;c<a;c++){var e=d[c].split("=");if(e!=null&&e!="undefined"){if(e[0]===b){if(e[1]!=null&&e[1]!="undefined"){f=e[1]}}}}return f},set:function(b,e,a,g,d,f){var c=encodeURIComponent(b)+"="+encodeURIComponent(e);if(a instanceof Date){c+="; expires="+a.toGMTString()}if(g){c+="; path="+g}if(d){c+="; domain="+d}if(f){c+="; secure"}document.cookie=c},unset:function(a,d,b,c){this.set(a,"",new Date(0),d,b,c)}};VA_WAP.namespace("SubCookie");VA_WAP.SubCookie={get:function(b,c){var a=this.getAll(b);if(a){return a[c]}else{return null}},getAll:function(a){var g=encodeURIComponent(a)+"=",e=document.cookie.indexOf(g),b=null,k={};if(e>-1){var j=document.cookie.indexOf(";",e);if(j==-1){j=document.cookie.length}b=document.cookie.substring(e+g.length,j);if(b.length>0){var h=b.split("&");for(var d=0,f=h.length;d<f;d++){var c=h[d].split("=");k[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}return k}}return k},set:function(b,f,e,a,h,d,g){var c=this.getAll(b)||{};c[f]=e;this.setAll(b,c,a,h,d,g)},setAll:function(c,b,d,j,g,a){var h=encodeURIComponent(c)+"=";var e=new Array();for(var f in b){if(f.length>0&&b.hasOwnProperty(f)){e.push(encodeURIComponent(f)+"="+encodeURIComponent(b[f]))}}if(e.length>0){h+=e.join("&");if(d instanceof Date){h+="; expires="+d.toGMTString()}if(j){h+="; path="+j}if(g){h+="; domain="+g}if(a){h+="; secure"}}else{h+="; expires="+(new Date(0)).toGMTString()}document.cookie=h},unset:function(a,d,f,c,e){var b=this.getAll(a);if(b){delete b[d];this.setAll(a,b,null,f,c,e)}},unsetAll:function(a,d,b,c){this.setAll(a,null,new Date(0),d,b,c)}};VA_WAP.namespace("vawap");VA_WAP.vawap={getScript:function(b){var a=document.createElement("script");a.src=b;document.getElementsByTagName("head")[0].appendChild(a)},prepare:function(){var m=new Date().getTime();VA_WAP.begintime=m;VA_WAP.requestid=VA_WAP.Lang.timeSeq32();var p=window.location.protocol.toLowerCase();VA_WAP.protocol=p;VA_WAP.resolution=window.screen.width+"*"+window.screen.height;var d="//vamr.vancl.com:";var a=p=="https:"?443:80;VA_WAP.server=p+d+a;var y=window.location.hostname.toLowerCase();VA_WAP.domain=y;var s=VA_WAP.Http.isIp(y);var q=y.lastIndexOf(".");if(q>0){q=y.lastIndexOf(".",q-1)}var w=s?y:(q==-1?("."+y):y.substring(q));VA_WAP.domain1=w;var h=window.location.pathname;if(VA_WAP.Lang.isEmpty(h)){h="/"}VA_WAP.uri=h;var g=window.location.search;if(g.length>0){g=g.substring(1)}VA_WAP.query=g;var x=VA_WAP.Http.getQueryStringArgs();var u=x.source;if(VA_WAP.Lang.isNone(u)){u=null}var c=(window.location.hash.length>0?window.location.hash.substring(1):"");if(VA_WAP.Lang.isNone(c)){c="-"}VA_WAP.source=u;VA_WAP.hash=c;var n=document.referrer;if(n==null||(typeof n=="undefined")||n==""){VA_WAP.Cookie.unset("va_wapclick","/",VA_WAP.domain1,null)}else{if(n.indexOf(".vancl.com")==-1){VA_WAP.Cookie.unset("va_wapclick","/",VA_WAP.domain1,null)}}VA_WAP.referer=n;VA_WAP.useragent=navigator.userAgent;var f=VA_WAP.Cookie.get("sid");if((typeof f=="undefined")||f==null||f==""){f="-"}var v=VA_WAP.Cookie.get("va_wsid");var t=null;if(v!=null&&v==f){t="g"}else{if(n==null||(typeof n=="undefined")||n==""){t="l";VA_WAP.Cookie.unset("va_wapclick","/",VA_WAP.domain1,null)}else{if(n.indexOf(".vancl.com")==-1){t="l";VA_WAP.Cookie.unset("va_wapclick","/",VA_WAP.domain1,null)}else{t="g"}}v=f}VA_WAP.sid=v;VA_WAP.visitsequence=t;var r=new Date();r.setTime(m+24*60*60*1000);VA_WAP.Cookie.set("va_wsid",v,r,"/",VA_WAP.domain1,null);var e=VA_WAP.SubCookie.getAll("va_wapclick");VA_WAP.parentrequestid=(typeof e.rid=="undefined")?"-":e.rid;VA_WAP.clickid=(typeof e.cid=="undefined")?"-":e.cid;VA_WAP.trackurl=(typeof e.turl=="undefined")?"-":decodeURIComponent(e.turl);VA_WAP.trackname=(typeof e.tname=="undefined")?"-":e.tname;VA_WAP.tracklabel=VA_WAP.Lang.trim((typeof e.tlabel=="undefined")?"-":e.tlabel);var b=VA_WAP.SubCookie.getAll("va_wapvisit");var k=b.uid;var j=b.uvc;if(VA_WAP.Lang.isNone(k)){k=VA_WAP.Lang.timeSeq32();j=1;b.uid=k;b.uvc=j;b.ft=m;b.lt=m;b.tt=m}else{if(t=="l"){try{j=Number(j)+1;if(Number(j)>999){j=999}}catch(l){j=1}b.uvc=j;b.lt=b.tt;b.tt=m}else{try{j=Number(j);if(Number(j)>999){j=999}}catch(l){j=1}b.uvc=j}}VA_WAP.uid=b.uid;VA_WAP.uservisitcount=b.uvc;VA_WAP.firsttime=b.ft;VA_WAP.lasttime=b.lt;VA_WAP.thistime=b.tt;var o=new Date();o.setTime(m+365*24*60*60*1000);VA_WAP.SubCookie.setAll("va_wapvisit",b,o,"/",VA_WAP.domain1,null)},request:function(){try{if(typeof VA_WAP.server!="undefined"){var f=VA_WAP.referer;var d=VA_WAP.hash;var c=VA_WAP.trackname;var b=VA_WAP.tracklabel;var e=VA_WAP.server+"/wapvisit.ashx?";e+="version=1.130730";e+="&requestid="+VA_WAP.requestid;e+="&parentrequestid="+VA_WAP.parentrequestid;e+="&sid="+VA_WAP.sid;e+="&uid="+VA_WAP.uid;e+="&referer="+(f==""?"-":encodeURIComponent(f.replace(/[\r\n\t]/g," ").substring(0,400)));e+="&visitsequence="+VA_WAP.visitsequence;e+="&uservisitcount="+VA_WAP.uservisitcount;e+="&firsttime="+VA_WAP.firsttime;e+="&lasttime="+VA_WAP.lasttime;e+="&thistime="+VA_WAP.thistime;e+="&resolution="+encodeURIComponent(VA_WAP.resolution);e+="&title="+encodeURIComponent(document.title);e+="&hash="+(d==""?"-":encodeURIComponent(d));e+="&clickid="+VA_WAP.clickid;e+="&trackname="+(c==""?"-":encodeURIComponent(c.replace(/[\r\n\t\'\"]/g," ")));e+="&tracklabel="+(b==""?"-":encodeURIComponent(b.replace(/[\r\n\t\'\"]/g," ")));e+="&shopid="+(VA_WAP.shopid==""?"-":VA_WAP.shopid);e+="&pagetype="+(VA_WAP.pagetype==""?"-":VA_WAP.pagetype);e+="&wapversion="+(VA_WAP.wapver==""?"-":VA_WAP.wapver);VA_WAP.vawap.getScript(e)}}catch(a){}},loadtime:function(){try{if(typeof VA_WAP.server!="undefined"){var a=new Date().getTime()-VA_WAP.begintime;var d=VA_WAP.referer;var c=VA_WAP.server+"/waprender.ashx?";c+="version=1.130730";c+="&requestid="+VA_WAP.requestid;c+="&parentrequestid="+VA_WAP.parentrequestid;c+="&sid="+VA_WAP.sid;c+="&uid="+VA_WAP.uid;c+="&rendertime="+a;c+="&referer="+(d==""?"-":encodeURIComponent(d.replace(/[\r\n\t]/g," ").substring(0,400)));VA_WAP.vawap.getScript(c)}}catch(b){}},listenclick:function(){try{VA_WAP.Event.addHandler(document,"mousedown",function(e){var d=VA_WAP.Event.getTarget(e);if(d.nodeType==1){var f=VA_WAP.vawap.elementclicked(d);if(f==false){var c=VA_WAP.vawap.elementclicked(d.parentNode);if(c==false){var b=VA_WAP.vawap.elementclicked(d.parentNode.parentNode);if(b==false){var g=VA_WAP.vawap.elementclicked(d.parentNode.parentNode.parentNode);if(g==false){VA_WAP.vawap.elementclicked(d.parentNode.parentNode.parentNode)}}}}}})}catch(a){}},elementclicked:function(a){if(a==null){return true}if(a.nodeType!=1){return false}var d=false;var e=a.className;if(e==null||(typeof e=="undefined")){e=""}e=e.toLowerCase();var m=e.split(" ");for(var f=0;f<m.length;f++){if(m[f]=="track"){d=true;break}}var g=null;if(d){try{g=a.name}catch(h){}}if(d==false||(typeof g=="undefined")||g==null||g==""){g="-"}var j=a.nodeName.toLowerCase();var l=null;var c=null;if(j=="a"){try{l=a.innerHTML;var k=a.href;if((typeof k!="undefined")&&k!=null){if(/^https?:\/\/./i.test(k)){c=k}else{if(/^\/\/./i.test(k)){c=k}else{if(/^\/./i.test(k)){c=k}}}}c=encodeURIComponent(c)}catch(h){}}else{try{l=a.value;if((typeof l=="undefined")||l==null){l=a.title;if((typeof l=="undefined")||l==null){l=a.data}}}catch(h){}}if((typeof l=="undefined")||l==null){l="-"}try{if(typeof l!="string"){l=""}else{l=l.replace(/[\r\n\t\'\"]/g," ")}}catch(h){}l=VA_WAP.Lang.trim(l);if(l.length>100){l=encodeURIComponent(l.substring(0,100))}else{l=encodeURIComponent(l)}var b=VA_WAP.Lang.timeSeq32();if(d){VA_WAP.vawap.recordtrackclick(b,g,c,l)}if(j=="a"){VA_WAP.vawap.recordaclick(b,g,c,l)}return d||j=="a"},recordaclick:function(b,d,e,c){if(d==null||(typeof d=="undefined")||d==""){d="-"}if(c==null||(typeof c=="undefined")||c==""){c="-"}if(e==null||(typeof e=="undefined")||e==""){e="-"}var a={};a.rid=VA_WAP.requestid;a.cid=b;a.turl=e;a.tname=d;a.tlabel=c;var f=new Date();f.setTime(new Date().getTime()+60*1000);VA_WAP.SubCookie.setAll("va_wapclick",a,f,"/",VA_WAP.domain1,null)},recordtrackclick:function(a,c,d,b){if(c==null||(typeof c=="undefined")||c==""){c="-"}if(b==null||(typeof b=="undefined")||b==""){b="-"}if(d==null||(typeof d=="undefined")||d==""){d="-"}if(typeof VA_WAP.server!="undefined"){var f=VA_WAP.referer;var e=VA_WAP.server+"/wapclick.ashx?";e+="version=1.130730";e+="&clickid="+a;e+="&trackurl="+(d==""?"-":encodeURIComponent(d.replace(/[\r\n\t]/g," ").substring(0,400)));e+="&trackname="+(c==""?"-":encodeURIComponent(c.replace(/[\r\n\t]/g," ").substring(0,400)));e+="&tracklabel="+(b==""?"-":encodeURIComponent(b.replace(/[\r\n\t]/g," ").substring(0,400)));e+="&requestid="+VA_WAP.requestid;e+="&sid="+VA_WAP.sid;e+="&uid="+VA_WAP.uid;e+="&referer="+(f==""?"-":encodeURIComponent(f.replace(/[\r\n\t]/g," ").substring(0,400)));e+="&shopid="+(VA_WAP.shopid==""?"-":VA_WAP.shopid);e+="&pagetype="+(VA_WAP.pagetype==""?"-":VA_WAP.pagetype);e+="&wapversion="+(VA_WAP.wapver==""?"-":VA_WAP.wapver);VA_WAP.vawap.getScript(e)}},send:function(){try{if(typeof VA_WAP.readyed!="undefined"){return}VA_WAP.readyed="1";VA_WAP.vawap.prepare();VA_WAP.vawap.request()}catch(a){}},loaded:function(){try{if(typeof VA_WAP.loaded!="undefined"){return}VA_WAP.loaded="1";VA_WAP.vawap.listenclick()}catch(a){}},unloaded:function(){try{if(typeof VA_WAP.unloaded!="undefined"){return}VA_WAP.unloaded="1";VA_WAP.vawap.loadtime()}catch(a){}}};try{window.addEventListener("DOMContentLoaded",function(){VA_WAP.vawap.send()})}catch(err){}try{window.addEventListener("load",function(){VA_WAP.vawap.loaded()})}catch(err){}try{window.addEventListener("beforeunload",function(){VA_WAP.vawap.unloaded()})}catch(err){}try{window.addEventListener("unload",function(){VA_WAP.vawap.unloaded()})}catch(err){};